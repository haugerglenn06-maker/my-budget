<!DOCTYPE html>
<html>
    <head>
        <title>Budget Scanner - Mobile</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    </head>
    <body class="bg-gray-900 text-white p-6">
        <div class="max-w-md mx-auto">
            <h1 class="text-xl font-bold mb-6 text-center text-blue-400">
                Scanner-enhet
            </h1>

            <div class="mb-4">
                <input
                    id="master-id"
                    type="text"
                    placeholder="Ange Master ID från datorn"
                    class="w-full p-3 rounded bg-gray-800 border border-gray-700 mb-2"
                />
                <button
                    onclick="connectToMaster()"
                    class="w-full bg-blue-600 p-3 rounded font-bold"
                >
                    Anslut till Datorn
                </button>
            </div>

            <div id="scanner-ui" class="hidden space-y-4">
                <div
                    class="p-4 bg-green-900 border border-green-700 rounded text-center"
                >
                    ✅ Ansluten till Master
                </div>

                <div
                    class="border-2 border-dashed border-gray-600 h-48 flex items-center justify-center rounded-xl bg-gray-800"
                >
                    <p class="text-gray-400 text-sm">
                        [ Här aktiveras kameran senare ]
                    </p>
                </div>

                <button
                    onclick="sendSimulatedScan()"
                    class="w-full bg-green-500 p-4 rounded-xl font-bold text-lg"
                >
                    Skanna & Skicka (Test)
                </button>
            </div>
        </div>

        <script>
            let peer;
            let conn;

            function connectToMaster() {
                const masterId = document.getElementById("master-id").value;
                peer = new Peer(); // Skapar ett tillfälligt ID för mobilen

                peer.on("open", () => {
                    conn = peer.connect(masterId);
                    conn.on("open", () => {
                        document
                            .getElementById("scanner-ui")
                            .classList.remove("hidden");
                    });
                });
            }

            function sendSimulatedScan() {
                if (conn && conn.open) {
                    const mockData = {
                        name: "Mjölk 1.5L",
                        price: 18.5,
                        barcode: "7310865000001",
                        timestamp: new Date().toISOString(),
                    };
                    conn.send(mockData);
                    alert("Vara skickad till datorn!");
                }
            }
        </script>
    </body>
</html>
